# Отток клиентов из ТелеДом
## Цель
- предсказать отток клиентов

## Задачи 
1. Загрузка данных
2. Исследовательский анализ и предобработка данных
3. Обучение моделей
4. Тестирование модели и демонстрация её работы
5. Общий вывод по работе

## Данные
Для этой задачи заказчик предоставил данные с признаками:

Данные хранятся в Sqlite — СУБД, в которой база данных представлена одним файлом.

- `contract` — информация о договорах;
- `personal` — персональные данные клиентов;
- `internet` — информация об интернет-услугах;
- `phone` — информация об услугах телефонии.

**Таблица `contract`**

- `customerID` — ID абонента;
- `BeginDate` — дата начала действия договора;
- `EndDate` — дата окончания действия договора;
- `Type` — тип оплаты: раз в год-два или ежемесячно;
- `PaperlessBilling` — электронный расчётный лист;
- `PaymentMethod` — тип платежа;
- `MonthlyCharges` — расходы за месяц;
- `TotalCharges` — общие расходы абонента.

**Таблица `personal`**

- `customerID` — ID пользователя;
- `gender` — пол;
- `SeniorCitizen` — является ли абонент пенсионером;
- `Partner` — есть ли у абонента супруг или супруга;
- `Dependents` — есть ли у абонента дети.

**Таблица `internet`**

- `customerID` — ID пользователя;
- `InternetService` — тип подключения;
- `OnlineSecurity` — блокировка опасных сайтов;
- `OnlineBackup` — облачное хранилище файлов для резервного копирования данных;
- `DeviceProtection` — антивирус;
- `TechSupport` — выделенная линия технической поддержки;
- `StreamingTV` — стриминговое телевидение;
- `StreamingMovies` — каталог фильмов.

**Таблица `phone`**

- `customerID` — ID пользователя;
- `MultipleLines` — подключение телефона к нескольким линиям одновременно.

Информация о договорах актуальна на 1 февраля 2020.

## Используемые библиотеки
*pandas, numpy, matplotlib, random, seaborn, sklearn, warnings, phik, time, optuna, shap*

## Итоги
|Тип модели|DecisionTreeClassifier|LGBMClassifier|MLPClassifier|
|---|---|---|---|
|Длительность кросс-валидации, сек.|0.10|0.40|19.54|
|Значение метрики ROC_AUC на трейне|0.73|0.86|0.79|

Качество лучшей модели на тестовой выборке:
|Метрика|LGBMClassifier|
|---|---|
|ROC-AUC|0.91|
|Accuracy|0.91|

*В нашем случае точность в 91% говорит о том, что из 100 реальных случаев отказа от услуг компании модель сможет правильно предсказать 91 клиента.*

**Матрица ошибок:**

Для нас ошибка первого рода — классифицировать активного клиента как собирающегося отказаться от услуг, а ошибка второго рода — определить клиента, который хочет отказаться от услуг, как активного. Поэтому для нас будет важно получить минимальное количество ошибок второго рода (FN), так как для компании это отличный шанс предотвратить отток клиентов, зная кто собирается отказаться от услуг.

Учитывая описанные выше факторы и построенные графики есть минимальное количество ложных пропусков False Negative (ошибка второго рода) и самое высокое значение метрики Recall. Такой результат возможен с порогом 0.1:

|TN|FN|TP|FP|
|---|---|---|---|
|980|38|503|251|

Для компании, предоствляющей телекоммуникационные услуги важно присутствие клиентов с максимальной продолжительностью контракта. Чтобы достичь высокого показателя нужно стимулировать новых клиентов различными промо-акциями и предложениями. Проводить розыгрышы и конкурсы, реферальные программы и скидки на услуги. Так же важно отслеживать цены других компаний для оптимального поддержания стоимости услуг. Так как в телекоммуникационой отрасли достаточно большая конкуренция. Плюс к этому нужно особое внимание уделить клиентам, которые пользуются услугами примерно три года.
