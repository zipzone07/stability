# Предсказание ДТП
Нужно создать систему, которая могла бы оценить риск ДТП по выбранному маршруту движения.
 
## Цель иследования
- предсказать случится ДТП или нет
- создать систему оценки водительского риска при выдаче авто на основе вероятности предсказания мажорного класса
  
## Ход исследования
1. Загрузка таблицы SQL.
2. Первичное исследование таблиц
3. Статистический анализ факторов ДТП
4. Создать модель для оценки водительского риска
5. Найти лучшую модель
6. Проверить лучшую модель в работе
7. Сделать общий вывод по модели

## Используемые библиотеки
*pandas, numpy, matplotlib, random, seaborn, sklearn, warnings, lightgbm, sqlalchemy, jinja2, phik*

## Итоги
По итогу лучшей моделью является LGBMClassifier, с следующими результатами обучения:

|Модель|Значение метрики F1|
|---|---|
|GaussianNB|0.22|
|LinearSVC|0.62|
|LGBMClassifier|0.63|

|Модель|Длительность кросс-валидации|Значение метрики ROC-AUC|
|---|---|---|
|GaussianNB|0.3|0.81|
|LinearSVC|1.4|0.84|
|LGBMClassifier|3.6|0.93|

Чтобы создать адекватную систему оценки риска при выдаче авто необходимо больше информации о данных, например:

- полное признаковое описание по всем таблицам,
- конкретная задача от заказчика, а не размытая формулировка "создать систему, которая могла бы оценить риск ДТП по выбранному маршруту движения"

Так же отметим, что в данных есть много признаков совершенно не нужных для моделирования, например:

- insurance_premium — страховая премия
- party_sobriety — группа вляния алкоголя
- party_drug_physical — группа вляния наркотиков
- cellphone_in_use — использование мобильного телефона
  
Такие данные на самом деле не доступны в реальных задачах, ведь ДТП еще не произошло.

